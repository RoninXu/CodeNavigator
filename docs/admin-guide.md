# CodeNavigator ç®¡ç†å‘˜æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
3. [é…ç½®ç®¡ç†](#é…ç½®ç®¡ç†)
4. [ç›‘æ§è¿ç»´](#ç›‘æ§è¿ç»´)
5. [ç”¨æˆ·ç®¡ç†](#ç”¨æˆ·ç®¡ç†)
6. [æ•°æ®ç®¡ç†](#æ•°æ®ç®¡ç†)
7. [å®‰å…¨ç®¡ç†](#å®‰å…¨ç®¡ç†)
8. [æ€§èƒ½è°ƒä¼˜](#æ€§èƒ½è°ƒä¼˜)
9. [æ•…éšœå¤„ç†](#æ•…éšœå¤„ç†)
10. [ç³»ç»Ÿç»´æŠ¤](#ç³»ç»Ÿç»´æŠ¤)

---

## ğŸ—ï¸ ç³»ç»Ÿæ¦‚è¿°

### æ¶æ„ç»„ä»¶
CodeNavigator é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œä¸»è¦ç»„ä»¶åŒ…æ‹¬ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Nginx        â”‚    â”‚   Spring Boot   â”‚    â”‚     MySQL       â”‚
â”‚  (åå‘ä»£ç†)      â”‚â”€â”€â”€â”€â”‚   (æ ¸å¿ƒåº”ç”¨)     â”‚â”€â”€â”€â”€â”‚   (æ•°æ®å­˜å‚¨)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
         â”‚              â”‚     Redis       â”‚              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   (ç¼“å­˜ç³»ç»Ÿ)     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   Prometheus    â”‚    â”‚   Elasticsearch â”‚
                   â”‚   (ç›‘æ§ç³»ç»Ÿ)     â”‚    â”‚   (æ—¥å¿—ç³»ç»Ÿ)     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ
- **åç«¯**: Spring Boot 3.2, Java 17
- **æ•°æ®åº“**: MySQL 8.0, Redis 7
- **å‰ç«¯**: Thymeleaf, Bootstrap 5, JavaScript
- **å®¹å™¨åŒ–**: Docker, Docker Compose
- **ç›‘æ§**: Prometheus, Grafana, ELK Stack
- **ä»£ç†**: Nginx
- **AIæœåŠ¡**: LangChain4j, OpenAI API

### ç³»ç»Ÿè¦æ±‚
- **CPU**: æœ€ä½ 4æ ¸ï¼Œæ¨è 8æ ¸+
- **å†…å­˜**: æœ€ä½ 8GBï¼Œæ¨è 16GB+
- **å­˜å‚¨**: æœ€ä½ 100GB SSDï¼Œæ¨è 500GB+
- **ç½‘ç»œ**: ç¨³å®šçš„äº’è”ç½‘è¿æ¥
- **æ“ä½œç³»ç»Ÿ**: Linux (Ubuntu 20.04+/CentOS 8+)

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å®‰è£… Docker å’Œ Docker Compose
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo pip3 install docker-compose

# åˆ›å»ºéƒ¨ç½²ç›®å½•
sudo mkdir -p /opt/codenavigator
cd /opt/codenavigator

# å…‹éš†é¡¹ç›®
git clone https://github.com/your-org/codenavigator.git .
```

#### 2. ç¯å¢ƒå˜é‡é…ç½®
```bash
# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
vim .env
```

å¿…éœ€çš„ç¯å¢ƒå˜é‡ï¼š
```env
# æ•°æ®åº“é…ç½®
DB_PASSWORD=your_secure_password
MYSQL_ROOT_PASSWORD=your_root_password

# Redisé…ç½®
REDIS_PASSWORD=your_redis_password

# AIæœåŠ¡é…ç½®
OPENAI_API_KEY=your_openai_api_key

# ç›‘æ§é…ç½®
GRAFANA_PASSWORD=your_grafana_password

# å‘Šè­¦é…ç½®
SMTP_HOST=smtp.gmail.com:587
SMTP_USERNAME=your_email@gmail.com
SMTP_PASSWORD=your_app_password
CRITICAL_ALERT_EMAIL=admin@yourdomain.com
WARNING_ALERT_EMAIL=dev@yourdomain.com

# åŸŸåé…ç½®
DOMAIN_NAME=yourdomain.com
```

#### 3. SSLè¯ä¹¦é…ç½®
```bash
# åˆ›å»ºSSLç›®å½•
sudo mkdir -p ssl

# ä½¿ç”¨Let's Encryptè·å–å…è´¹è¯ä¹¦
sudo apt install certbot
sudo certbot certonly --standalone -d yourdomain.com

# å¤åˆ¶è¯ä¹¦åˆ°sslç›®å½•
sudo cp /etc/letsencrypt/live/yourdomain.com/fullchain.pem ssl/cert.pem
sudo cp /etc/letsencrypt/live/yourdomain.com/privkey.pem ssl/key.pem
sudo chmod 644 ssl/*.pem
```

#### 4. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
docker-compose -f docker-compose.prod.yml up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f
```

### å¼€å‘ç¯å¢ƒéƒ¨ç½²

#### 1. å¿«é€Ÿå¯åŠ¨
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-org/codenavigator.git
cd codenavigator

# å¯åŠ¨å¼€å‘ç¯å¢ƒ
mvn spring-boot:run -pl codenavigator-app
```

#### 2. Dockerå¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡
docker-compose up -d mysql redis

# è¿è¡Œåº”ç”¨
mvn spring-boot:run -pl codenavigator-app
```

---

## âš™ï¸ é…ç½®ç®¡ç†

### åº”ç”¨é…ç½®

#### æ•°æ®åº“é…ç½®
```yaml
# application-prod.yml
spring:
  datasource:
    url: jdbc:mysql://${DB_HOST}:${DB_PORT}/${DB_NAME}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    hikari:
      maximum-pool-size: 50
      minimum-idle: 10
      idle-timeout: 600000
      max-lifetime: 1800000
```

#### Redisé…ç½®
```yaml
spring:
  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}
      password: ${REDIS_PASSWORD}
      lettuce:
        pool:
          max-active: 50
          max-idle: 20
          min-idle: 5
```

#### AIæœåŠ¡é…ç½®
```yaml
langchain4j:
  open-ai:
    chat-model:
      api-key: ${OPENAI_API_KEY}
      model-name: gpt-4
      temperature: 0.5
      timeout: 30s
```

### Nginxé…ç½®
ä¸»è¦é…ç½®æ–‡ä»¶ä½äº `nginx/conf.d/codenavigator.conf`ï¼š

```nginx
# SSLé…ç½®
ssl_certificate /etc/nginx/ssl/cert.pem;
ssl_certificate_key /etc/nginx/ssl/key.pem;

# å®‰å…¨å¤´
add_header Strict-Transport-Security "max-age=63072000" always;
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;

# è´Ÿè½½å‡è¡¡
upstream codenavigator_backend {
    server app:8080 max_fails=3 fail_timeout=30s;
    keepalive 32;
}
```

### ç›‘æ§é…ç½®

#### Prometheusé…ç½®
```yaml
# monitoring/prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: 'codenavigator-app'
    static_configs:
      - targets: ['app:8080']
    metrics_path: /actuator/prometheus
```

#### å‘Šè­¦è§„åˆ™
```yaml
# monitoring/alerts/application-alerts.yml
groups:
  - name: codenavigator-application
    rules:
      - alert: ApplicationDown
        expr: up{job="codenavigator-app"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "CodeNavigatoråº”ç”¨ä¸å¯ç”¨"
```

---

## ğŸ“Š ç›‘æ§è¿ç»´

### ç›‘æ§è®¿é—®åœ°å€
- **Grafana**: http://your-domain:3000
- **Prometheus**: http://your-domain:9090
- **AlertManager**: http://your-domain:9093
- **Kibana**: http://your-domain:5601

### å…³é”®ç›‘æ§æŒ‡æ ‡

#### åº”ç”¨æŒ‡æ ‡
```promql
# HTTPè¯·æ±‚é€Ÿç‡
rate(http_server_requests_total[5m])

# å“åº”æ—¶é—´95ç™¾åˆ†ä½
histogram_quantile(0.95, rate(http_server_requests_duration_seconds_bucket[5m]))

# é”™è¯¯ç‡
rate(http_server_requests_total{status=~"5.."}[5m]) / rate(http_server_requests_total[5m])

# JVMå†…å­˜ä½¿ç”¨ç‡
jvm_memory_used_bytes{area="heap"} / jvm_memory_max_bytes{area="heap"}
```

#### ç³»ç»ŸæŒ‡æ ‡
```promql
# CPUä½¿ç”¨ç‡
100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)

# å†…å­˜ä½¿ç”¨ç‡
(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100

# ç£ç›˜ä½¿ç”¨ç‡
(1 - (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"})) * 100
```

### æ—¥å¿—ç®¡ç†

#### æ—¥å¿—çº§åˆ«é…ç½®
```yaml
logging:
  level:
    root: INFO
    com.codenavigator: INFO
    org.springframework: WARN
```

#### æ—¥å¿—è½®è½¬é…ç½®
```yaml
logging:
  logback:
    rollingpolicy:
      max-file-size: 100MB
      max-history: 30
      total-size-cap: 3GB
```

### å¤‡ä»½ç­–ç•¥

#### æ•°æ®åº“å¤‡ä»½
```bash
#!/bin/bash
# æ¯æ—¥å¤‡ä»½è„šæœ¬
BACKUP_DIR="/opt/backups/mysql"
DATE=$(date +%Y%m%d_%H%M%S)

docker exec mysql mysqldump -u root -p$MYSQL_ROOT_PASSWORD \
  --single-transaction --routines --triggers code_navigator \
  > $BACKUP_DIR/codenavigator_$DATE.sql

# ä¿ç•™30å¤©å¤‡ä»½
find $BACKUP_DIR -name "*.sql" -mtime +30 -delete
```

#### é…ç½®å¤‡ä»½
```bash
#!/bin/bash
# é…ç½®æ–‡ä»¶å¤‡ä»½
tar -czf /opt/backups/config_$(date +%Y%m%d).tar.gz \
  /opt/codenavigator/nginx/ \
  /opt/codenavigator/monitoring/ \
  /opt/codenavigator/.env
```

---

## ğŸ‘¥ ç”¨æˆ·ç®¡ç†

### ç”¨æˆ·è§’è‰²
- **è¶…çº§ç®¡ç†å‘˜**: ç³»ç»Ÿå…¨æƒé™
- **ç®¡ç†å‘˜**: ç”¨æˆ·å’Œå†…å®¹ç®¡ç†æƒé™
- **è®²å¸ˆ**: è¯¾ç¨‹å’Œå­¦ä¹ è·¯å¾„ç®¡ç†æƒé™
- **å­¦å‘˜**: åŸºç¡€å­¦ä¹ åŠŸèƒ½æƒé™

### ç”¨æˆ·æ“ä½œ

#### åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
```sql
-- åœ¨æ•°æ®åº“ä¸­ç›´æ¥åˆ›å»ºç®¡ç†å‘˜
INSERT INTO users (username, email, password_hash, role, status, created_at) 
VALUES ('admin', 'admin@yourdomain.com', 'hashed_password', 'ADMIN', 'ACTIVE', NOW());
```

#### æ‰¹é‡ç”¨æˆ·å¯¼å…¥
```bash
# ä½¿ç”¨CSVæ–‡ä»¶æ‰¹é‡å¯¼å…¥ç”¨æˆ·
curl -X POST http://your-domain/admin/users/import \
  -H "Authorization: Bearer $ADMIN_TOKEN" \
  -F "file=@users.csv"
```

#### ç”¨æˆ·çŠ¶æ€ç®¡ç†
```bash
# æ¿€æ´»ç”¨æˆ·
curl -X PUT http://your-domain/admin/users/{userId}/activate \
  -H "Authorization: Bearer $ADMIN_TOKEN"

# ç¦ç”¨ç”¨æˆ·
curl -X PUT http://your-domain/admin/users/{userId}/deactivate \
  -H "Authorization: Bearer $ADMIN_TOKEN"
```

### æƒé™ç®¡ç†
```yaml
# æƒé™é…ç½®ç¤ºä¾‹
permissions:
  admin:
    - user.manage
    - content.manage
    - system.monitor
  instructor:
    - course.create
    - course.edit
    - student.view
  student:
    - course.view
    - progress.track
```

---

## ğŸ—„ï¸ æ•°æ®ç®¡ç†

### æ•°æ®åº“ç®¡ç†

#### è¿æ¥æ•°æ®åº“
```bash
# è¿›å…¥MySQLå®¹å™¨
docker exec -it codenavigator-mysql mysql -u root -p

# æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
SHOW DATABASES;
USE code_navigator;
SHOW TABLES;
```

#### æ€§èƒ½ä¼˜åŒ–
```sql
-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SHOW VARIABLES LIKE 'slow_query_log';
SHOW VARIABLES LIKE 'long_query_time';

-- åˆ†æè¡¨
ANALYZE TABLE users;
ANALYZE TABLE learning_paths;
ANALYZE TABLE user_progress;

-- ä¼˜åŒ–è¡¨
OPTIMIZE TABLE users;
OPTIMIZE TABLE conversations;
```

#### ç´¢å¼•ç®¡ç†
```sql
-- æŸ¥çœ‹è¡¨ç´¢å¼•
SHOW INDEX FROM users;

-- åˆ›å»ºå¤åˆç´¢å¼•
CREATE INDEX idx_user_progress_composite ON user_progress(user_id, learning_path_id, status);

-- ç›‘æ§ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SELECT 
  TABLE_NAME,
  INDEX_NAME,
  SEQ_IN_INDEX,
  COLUMN_NAME,
  CARDINALITY
FROM INFORMATION_SCHEMA.STATISTICS 
WHERE TABLE_SCHEMA = 'code_navigator';
```

### Redisç®¡ç†

#### è¿æ¥Redis
```bash
# è¿›å…¥Rediså®¹å™¨
docker exec -it codenavigator-redis redis-cli -a $REDIS_PASSWORD

# æŸ¥çœ‹Redisä¿¡æ¯
INFO memory
INFO stats
```

#### ç¼“å­˜ç®¡ç†
```bash
# æŸ¥çœ‹æ‰€æœ‰é”®
KEYS *

# æŸ¥çœ‹ç‰¹å®šæ¨¡å¼çš„é”®
KEYS codenavigator:user:*

# æ¸…é™¤ç‰¹å®šç¼“å­˜
DEL codenavigator:user:123

# æ¸…é™¤æ‰€æœ‰ç¼“å­˜ï¼ˆæ…ç”¨ï¼‰
FLUSHALL
```

### æ•°æ®è¿ç§»

#### æ•°æ®å¯¼å‡º
```bash
# å¯¼å‡ºç”¨æˆ·æ•°æ®
docker exec mysql mysqldump -u root -p$MYSQL_ROOT_PASSWORD \
  code_navigator users > users_export.sql

# å¯¼å‡ºå­¦ä¹ è¿›åº¦
docker exec mysql mysqldump -u root -p$MYSQL_ROOT_PASSWORD \
  code_navigator user_progress > progress_export.sql
```

#### æ•°æ®å¯¼å…¥
```bash
# å¯¼å…¥æ•°æ®
docker exec -i mysql mysql -u root -p$MYSQL_ROOT_PASSWORD \
  code_navigator < users_import.sql
```

---

## ğŸ”’ å®‰å…¨ç®¡ç†

### å®‰å…¨é…ç½®

#### SSL/TLSé…ç½®
```nginx
# ç°ä»£SSLé…ç½®
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;
ssl_prefer_server_ciphers off;

# HSTS
add_header Strict-Transport-Security "max-age=63072000" always;
```

#### é˜²ç«å¢™é…ç½®
```bash
# Ubuntu/Debian
sudo ufw enable
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw deny 3306/tcp  # æ•°æ®åº“ç«¯å£ä»…å†…ç½‘è®¿é—®
sudo ufw deny 6379/tcp  # Redisç«¯å£ä»…å†…ç½‘è®¿é—®

# CentOS/RHEL
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

#### è®¿é—®æ§åˆ¶
```nginx
# é™åˆ¶ç®¡ç†æ¥å£è®¿é—®
location /admin {
    allow 192.168.1.0/24;  # ä»…å…è®¸å†…ç½‘è®¿é—®
    deny all;
    proxy_pass http://codenavigator_backend;
}

# APIé™æµ
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
limit_req_zone $binary_remote_addr zone=login:10m rate=1r/s;
```

### å®‰å…¨ç›‘æ§

#### ç™»å½•ç›‘æ§
```sql
-- ç›‘æ§å¼‚å¸¸ç™»å½•
SELECT 
  ip_address,
  COUNT(*) as failed_attempts,
  MAX(attempted_at) as last_attempt
FROM login_attempts 
WHERE success = false 
  AND attempted_at > DATE_SUB(NOW(), INTERVAL 1 HOUR)
GROUP BY ip_address
HAVING failed_attempts > 5;
```

#### å®‰å…¨æ—¥å¿—
```bash
# ç›‘æ§Nginxè®¿é—®æ—¥å¿—ä¸­çš„å¼‚å¸¸è¯·æ±‚
tail -f /var/log/nginx/access.log | grep -E "(40[0-9]|50[0-9])"

# ç›‘æ§è®¤è¯å¤±è´¥
grep "authentication failed" /var/log/codenavigator/codenavigator.log
```

### æ•°æ®ä¿æŠ¤

#### æ•æ„Ÿæ•°æ®åŠ å¯†
```java
// æ•°æ®åº“æ•æ„Ÿå­—æ®µåŠ å¯†
@Entity
public class User {
    @Column(name = "email")
    @Convert(converter = EncryptionConverter.class)
    private String email;
    
    @Column(name = "phone")
    @Convert(converter = EncryptionConverter.class)
    private String phone;
}
```

#### å¤‡ä»½åŠ å¯†
```bash
# åŠ å¯†å¤‡ä»½
mysqldump -u root -p$MYSQL_ROOT_PASSWORD code_navigator | \
  gpg --cipher-algo AES256 --compress-algo 1 --symmetric \
  --output backup_$(date +%Y%m%d).sql.gpg
```

---

## âš¡ æ€§èƒ½è°ƒä¼˜

### JVMè°ƒä¼˜

#### å†…å­˜é…ç½®
```bash
# ç”Ÿäº§ç¯å¢ƒJVMå‚æ•°
JAVA_OPTS="-Xms2g -Xmx4g \
  -XX:+UseG1GC \
  -XX:+UseStringDeduplication \
  -XX:MaxGCPauseMillis=200 \
  -XX:+HeapDumpOnOutOfMemoryError \
  -XX:HeapDumpPath=/var/log/codenavigator/"
```

#### GCè°ƒä¼˜
```bash
# G1GCå‚æ•°è°ƒä¼˜
-XX:G1HeapRegionSize=16m
-XX:G1NewSizePercent=30
-XX:G1MaxNewSizePercent=40
-XX:G1MixedGCLiveThresholdPercent=85
-XX:G1MixedGCCountTarget=8
```

### æ•°æ®åº“è°ƒä¼˜

#### MySQLé…ç½®ä¼˜åŒ–
```ini
# my.cnf
[mysqld]
# å†…å­˜é…ç½®
innodb_buffer_pool_size = 4G
innodb_log_file_size = 256M
innodb_log_buffer_size = 64M

# è¿æ¥é…ç½®
max_connections = 1000
max_connect_errors = 100000

# æŸ¥è¯¢ç¼“å­˜
query_cache_type = 1
query_cache_size = 256M

# InnoDBé…ç½®
innodb_flush_log_at_trx_commit = 2
innodb_flush_method = O_DIRECT
```

#### æŸ¥è¯¢ä¼˜åŒ–
```sql
-- åˆ†ææ…¢æŸ¥è¯¢
SELECT 
  query_time,
  lock_time,
  rows_sent,
  rows_examined,
  sql_text
FROM mysql.slow_log 
ORDER BY query_time DESC 
LIMIT 10;

-- ä¼˜åŒ–å»ºè®®
EXPLAIN SELECT * FROM users WHERE email = 'user@example.com';
```

### ç¼“å­˜ä¼˜åŒ–

#### Redisé…ç½®
```redis
# redis.conf
maxmemory 2gb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
save 60 10000

# ç½‘ç»œä¼˜åŒ–
tcp-keepalive 300
timeout 0
```

#### ç¼“å­˜ç­–ç•¥
```java
// å¤šçº§ç¼“å­˜ç­–ç•¥
@Cacheable(value = "users", key = "#userId", unless = "#result == null")
public User getUserById(Long userId) {
    return userRepository.findById(userId);
}

@CacheEvict(value = "users", key = "#user.id")
public User updateUser(User user) {
    return userRepository.save(user);
}
```

### ç½‘ç»œä¼˜åŒ–

#### Nginxä¼˜åŒ–
```nginx
# å·¥ä½œè¿›ç¨‹æ•°
worker_processes auto;
worker_connections 4096;

# æ€§èƒ½ä¼˜åŒ–
sendfile on;
tcp_nopush on;
tcp_nodelay on;
keepalive_timeout 65;

# Gzipå‹ç¼©
gzip on;
gzip_vary on;
gzip_min_length 1000;
gzip_comp_level 6;
```

---

## ğŸš¨ æ•…éšœå¤„ç†

### å¸¸è§æ•…éšœ

#### åº”ç”¨æ— æ³•å¯åŠ¨
**ç—‡çŠ¶**: åº”ç”¨å¯åŠ¨å¤±è´¥
**æ’æŸ¥æ­¥éª¤**:
```bash
# 1. æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker logs codenavigator-app

# 2. æ£€æŸ¥é…ç½®æ–‡ä»¶
cat .env

# 3. éªŒè¯æ•°æ®åº“è¿æ¥
docker exec mysql mysql -u root -p$MYSQL_ROOT_PASSWORD -e "SELECT 1"

# 4. æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep 8080
```

#### æ•°æ®åº“è¿æ¥å¤±è´¥
**ç—‡çŠ¶**: åº”ç”¨æ— æ³•è¿æ¥æ•°æ®åº“
**æ’æŸ¥æ­¥éª¤**:
```bash
# 1. æ£€æŸ¥MySQLå®¹å™¨çŠ¶æ€
docker ps | grep mysql

# 2. æŸ¥çœ‹MySQLæ—¥å¿—
docker logs codenavigator-mysql

# 3. éªŒè¯ç½‘ç»œè¿æ¥
docker exec app ping mysql

# 4. æ£€æŸ¥ç”¨æˆ·æƒé™
docker exec mysql mysql -u root -p$MYSQL_ROOT_PASSWORD \
  -e "SELECT User, Host FROM mysql.user WHERE User='codenavigator'"
```

#### å†…å­˜ä¸è¶³
**ç—‡çŠ¶**: ç³»ç»Ÿå“åº”ç¼“æ…¢ï¼Œå†…å­˜ä½¿ç”¨ç‡é«˜
**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ
free -h
docker stats

# 2. è°ƒæ•´JVMå †å†…å­˜
vim docker-compose.prod.yml
# ä¿®æ”¹ JAVA_OPTS: "-Xms1g -Xmx3g"

# 3. é‡å¯åº”ç”¨
docker-compose restart app

# 4. ç›‘æ§å†…å­˜ä½¿ç”¨
watch -n 1 'free -h'
```

### ç´§æ€¥å¤„ç†æµç¨‹

#### æœåŠ¡ä¸­æ–­å¤„ç†
1. **ç«‹å³å“åº”** (5åˆ†é’Ÿå†…)
   - ç¡®è®¤æœåŠ¡çŠ¶æ€
   - å¯åŠ¨ç´§æ€¥å¤„ç†ç¨‹åº
   - é€šçŸ¥ç›¸å…³äººå‘˜

2. **é—®é¢˜å®šä½** (15åˆ†é’Ÿå†…)
   - æŸ¥çœ‹ç›‘æ§æŠ¥è­¦
   - åˆ†ææ—¥å¿—æ–‡ä»¶
   - ç¡®å®šæ•…éšœèŒƒå›´

3. **ç´§æ€¥æ¢å¤** (30åˆ†é’Ÿå†…)
   - å®æ–½å›æ»šè®¡åˆ’
   - é‡å¯å…³é”®æœåŠ¡
   - éªŒè¯æœåŠ¡æ¢å¤

4. **æ ¹å› åˆ†æ** (24å°æ—¶å†…)
   - è¯¦ç»†åˆ†ææ•…éšœåŸå› 
   - åˆ¶å®šæ”¹è¿›æªæ–½
   - æ›´æ–°åº”æ€¥é¢„æ¡ˆ

#### æ•°æ®æ¢å¤
```bash
# 1. åœæ­¢åº”ç”¨å†™å…¥
docker-compose stop app

# 2. ä»å¤‡ä»½æ¢å¤æ•°æ®
mysql -u root -p$MYSQL_ROOT_PASSWORD code_navigator < backup_latest.sql

# 3. éªŒè¯æ•°æ®å®Œæ•´æ€§
mysql -u root -p$MYSQL_ROOT_PASSWORD -e "
  SELECT COUNT(*) FROM code_navigator.users;
  SELECT COUNT(*) FROM code_navigator.conversations;
"

# 4. é‡å¯åº”ç”¨
docker-compose start app
```

---

## ğŸ”§ ç³»ç»Ÿç»´æŠ¤

### å®šæœŸç»´æŠ¤ä»»åŠ¡

#### æ¯æ—¥ç»´æŠ¤
```bash
#!/bin/bash
# daily_maintenance.sh

# 1. å¤‡ä»½æ•°æ®åº“
/opt/scripts/backup_database.sh

# 2. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
find /tmp -name "*.tmp" -mtime +1 -delete

# 3. æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h | awk '$5 > 80 {print "Warning: " $1 " is " $5 " full"}'

# 4. æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps | grep -v "Up" && echo "Some services are down!"
```

#### æ¯å‘¨ç»´æŠ¤
```bash
#!/bin/bash
# weekly_maintenance.sh

# 1. ä¼˜åŒ–æ•°æ®åº“
docker exec mysql mysql -u root -p$MYSQL_ROOT_PASSWORD -e "
  OPTIMIZE TABLE code_navigator.users;
  OPTIMIZE TABLE code_navigator.conversations;
  OPTIMIZE TABLE code_navigator.user_progress;
"

# 2. æ¸…ç†è¿‡æœŸæ—¥å¿—
find /var/log -name "*.log" -mtime +30 -delete

# 3. æ›´æ–°ç³»ç»ŸåŒ…
apt update && apt upgrade -y

# 4. é‡å¯æœåŠ¡ï¼ˆä½å³°æœŸï¼‰
docker-compose restart
```

#### æ¯æœˆç»´æŠ¤
```bash
#!/bin/bash
# monthly_maintenance.sh

# 1. åˆ†ææ•°æ®åº“æ€§èƒ½
docker exec mysql mysqltuner

# 2. æ£€æŸ¥SSLè¯ä¹¦è¿‡æœŸ
openssl x509 -in ssl/cert.pem -noout -dates

# 3. å®‰å…¨å®¡è®¡
/opt/scripts/security_audit.sh

# 4. å®¹é‡è§„åˆ’è¯„ä¼°
/opt/scripts/capacity_planning.sh
```

### ç‰ˆæœ¬æ›´æ–°

#### æ›´æ–°æµç¨‹
1. **å‡†å¤‡é˜¶æ®µ**
   ```bash
   # å¤‡ä»½å½“å‰ç‰ˆæœ¬
   docker-compose down
   tar -czf backup_$(date +%Y%m%d).tar.gz /opt/codenavigator
   
   # ä¸‹è½½æ–°ç‰ˆæœ¬
   git fetch origin
   git checkout v1.1.0
   ```

2. **æµ‹è¯•é˜¶æ®µ**
   ```bash
   # åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
   docker-compose -f docker-compose.test.yml up -d
   
   # è¿è¡Œæµ‹è¯•å¥—ä»¶
   mvn test
   ```

3. **éƒ¨ç½²é˜¶æ®µ**
   ```bash
   # åœæ­¢æœåŠ¡
   docker-compose -f docker-compose.prod.yml down
   
   # æ›´æ–°é•œåƒ
   docker-compose -f docker-compose.prod.yml build
   
   # å¯åŠ¨æ–°ç‰ˆæœ¬
   docker-compose -f docker-compose.prod.yml up -d
   ```

4. **éªŒè¯é˜¶æ®µ**
   ```bash
   # å¥åº·æ£€æŸ¥
   curl -f http://localhost:8080/actuator/health
   
   # åŠŸèƒ½éªŒè¯
   /opt/scripts/smoke_test.sh
   ```

### ç›‘æ§å’Œå‘Šè­¦

#### ç³»ç»Ÿç›‘æ§è„šæœ¬
```bash
#!/bin/bash
# system_monitor.sh

# CPUä½¿ç”¨ç‡æ£€æŸ¥
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | awk -F% '{print $1}')
if (( $(echo "$CPU_USAGE > 80" | bc -l) )); then
    echo "High CPU usage: $CPU_USAGE%"
    # å‘é€å‘Šè­¦
fi

# å†…å­˜ä½¿ç”¨ç‡æ£€æŸ¥
MEM_USAGE=$(free | grep Mem | awk '{printf("%.2f"), $3/$2 * 100.0}')
if (( $(echo "$MEM_USAGE > 80" | bc -l) )); then
    echo "High memory usage: $MEM_USAGE%"
    # å‘é€å‘Šè­¦
fi

# ç£ç›˜ä½¿ç”¨ç‡æ£€æŸ¥
DISK_USAGE=$(df / | tail -1 | awk '{print $5}' | sed 's/%//')
if [ $DISK_USAGE -gt 80 ]; then
    echo "High disk usage: $DISK_USAGE%"
    # å‘é€å‘Šè­¦
fi
```

#### åº”ç”¨å¥åº·æ£€æŸ¥
```bash
#!/bin/bash
# health_check.sh

# æ£€æŸ¥åº”ç”¨å“åº”
RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" http://localhost:8080/actuator/health)
if [ $RESPONSE -ne 200 ]; then
    echo "Application health check failed: HTTP $RESPONSE"
    # å°è¯•é‡å¯æœåŠ¡
    docker-compose restart app
fi

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
DB_STATUS=$(docker exec mysql mysql -u root -p$MYSQL_ROOT_PASSWORD -e "SELECT 1" 2>/dev/null)
if [ $? -ne 0 ]; then
    echo "Database connection failed"
    # å‘é€å‘Šè­¦
fi
```

---

## ğŸ“ æ”¯æŒè”ç³»

### æŠ€æœ¯æ”¯æŒ
- **é‚®ç®±**: admin-support@codenavigator.com
- **ç”µè¯**: +86-400-XXX-XXXX
- **åœ¨çº¿æ–‡æ¡£**: https://docs.codenavigator.com

### ç´§æ€¥è”ç³»
- **24/7çƒ­çº¿**: +86-138-XXXX-XXXX
- **ç´§æ€¥é‚®ç®±**: emergency@codenavigator.com
- **å€¼ç­ç¾¤**: [å¾®ä¿¡ç¾¤äºŒç»´ç ]

### ç¤¾åŒºæ”¯æŒ
- **å®˜æ–¹è®ºå›**: https://forum.codenavigator.com
- **GitHub Issues**: https://github.com/codenavigator/issues
- **QQç¾¤**: 123456789

---

**ğŸ“‹ éœ€è¦æ”¯æŒï¼Ÿ** éšæ—¶è”ç³»æˆ‘ä»¬çš„æŠ€æœ¯å›¢é˜Ÿï¼

**ğŸ› ï¸ æ„‰å¿«è¿ç»´ï¼** è®©æˆ‘ä»¬ä¸€èµ·æ„å»ºæ›´ç¨³å®šçš„CodeNavigatoræœåŠ¡ï¼